<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Station Monitor</title>
        <link rel="stylesheet" href="./style.css" />
    </head>
    <body>
        <main>
            <h1>Station Monitor</h1>
            <p>Loading...</p>
        </main>
        <script>
            // Generate code to refresh the page every 5 seconds
            setInterval(() => {
                // Get data from the server to display on the page
                fetch("/status")
                    .then((response) => response.json())
                    .then((data) => {
                        // Update the page with the new data
                        let dataHtml = "<h1>Station Monitor</h1>";
                        dataHtml += `<h2>Station Time: ${data.rpiTime}</h2>`;
                        dataHtml += "<h2>Distance Sensors:</h2>";
                        dataHtml += "<ul>";
                        Object.keys(data["distanceSensors"]).forEach(
                            (sensor) => {
                                let sensorData = `<li><p>${sensor}: <br/>`;
                                sensorData += `    Current Distance: ${data["distanceSensors"][sensor]["currentDistance"]} mm <br/>`;
                                sensorData += `    Occupied Distance: ${data["distanceSensors"][sensor]["occupiedDistance"]} mm <br/>`;
                                sensorData += `    Is Occupied: ${data["distanceSensors"][sensor]["isOccupied"]} mm <br/>`;
                                sensorData += "</p></li>";
                                dataHtml += sensorData;
                            }
                        );
                        dataHtml += "</ul>";
                        dataHtml += "<h2>Reflective Sensors:</h2>";
                        document.querySelector("main").innerHTML = dataHtml;
                    })
                    .catch((error) =>
                        console.error("Error fetching data:", error)
                    );
            }, 1000);
        </script>
    </body>
</html>
